# Page Reader (PageR)

## Содержание
- [Установка](#установка)
- [Информация для разработчиков](#информация-для-разработчиков)


## Установка
Предварительно установить
- [OCR-Tesseract](https://tesseract-ocr.github.io/tessdoc/Installation.html)
- [Java-PDF-Parser](https://github.com/YRL-AIDA/Java-PDF-Parser/tree/main)

Предварительная установка poppler для mac 
 ```
 brew install poppler
 ```

 Предварительная установка poppler для linux
 ```
 apt-get install poppler-utils
 ```

```
pager-install-models
```


## Информация для разработчиков
<!--описание коммитов-->
### Описание коммитов
| Название | Описание                                                        |
|----------|-----------------------------------------------------------------|
| build	   | Сборка проекта или изменения внешних зависимостей               |
| sec      | Безопасность, уязвимости                                        |
| ci       | Настройка CI и работа со скриптами                              |
| docs	   | Обновление документации                                         |
| comment  | Добавление комментариев в коде и readme                         |
| feat	   | Добавление нового функционала                                   |
| fix	   | Исправление ошибок                                              |
| perf	   | Изменения направленные на улучшение производительности          |
| refactor | Правки кода без исправления ошибок или добавления новых функций |
| revert   | Откат на предыдущие коммиты                                     |
| style	   | Правки по кодстайлу (табы, отступы, точки, запятые и т.д.)      |
| test	   | Добавление тестов                                               |

<!--структура проекта -->
### Структура проекта
```
.
├── pager - папка проекта
|   └── page_model - папка модели страницы
|   |   ├── image2phis.py - модель от изображения к структурее
|   |   ├── page_model.py - базовая модель страницы (собираемой из блоков)
|   |   └── sub_models - блоки модели
|   |   |   ├── base_sub_model.py  - базовая модель блока
|   |   |   ├── dtype - типы данных
|   |   |   ├── image_model - блок изображения
|   |   |   ├── pdf_model - блок pdf
|   |   |   ├── words_model - блок работы со словами
|   |   |   ├── words_and_styles_model - блок работы со словами их стилями
|   |   |   └── phisical_model -блок работы с физическими сегментами
```


### Запустить через Docker

```
sudo docker build -t pager .
```
```
sudo docker run -it -p 8000:8000 pager
```


### Пример запросов:

Запросы после можно посмотреть
```
http://127.0.0.1:8000/docs
```

Для обработки файлов (`http://127.0.0.1:8000/`) необходимо передать бинарный файл (pdf, jpeg, png)
И инструкцию с полями
```
{
    "only_text": true, # Без сегментации
    "glam_rows": true, # Обработка pdf по строкам
    "is_images": true  # Обработка pdf как набор изображений
}
```

- Если документ PDF, то опция `"glam_rows": true` позволяет обработать его по строкам
- Если документ PDF, то по умолчанию он распознается с использованием precisionPDF, но через опцию `"is_images": true`, можно рассматривать pdf как изображение
- Если документ изображение, то он обрабатывается по словам (строк нет)



curl -X POST "http://127.0.0.1:8000/" -F "file=@/path/file.pdf" -F 'process={"glam_rows": true}'